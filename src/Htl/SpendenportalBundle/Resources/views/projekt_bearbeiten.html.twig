{% if is_granted('ROLE_RECEIVER') %}

    {% embed "HtlSpendenportalBundle::header.html.twig" %}
        {# override the title-tag text #}
        {% block title_text %}
            Spendenverbindet | PROJEKT BEARBEITEN
        {% endblock %}
    {% endembed %}

    <div ng-init="initBearbeiten()" class="helper-navbar"></div>

    <div class="container">
        <form method="POST" action="/updateProject" enctype="multipart/form-data" >

            <div class="row fisrt-ent-section">
                <div class="col-xs-12 col-md-6 text-center"><h2>PROJEKT BEARBEITEN</h2></div>
                <div class="col-xs-12 col-md-6">
                    <div class="row second-ent-section text-center">
                        <button id="saveButtonId" type="submit" style="margin-top:27px;" class="uk-button uk-button-primary"><span id="btnTextId" style="font-size:18px;">PROJEKT GESPEICHERT</span></button>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-12 col-sm-6" style="padding:50px;padding-top: 0">

                    <img id="image" src="{{ asset('bundles/htlspendenportal/img/[[projektInfoBearbeiten[0].titlePictureUrl]]') }}" />

                    <input name="titlePictureUrl" style="display:none" id="myupload" type="file" size="100" accept="image/*">

                    <div class="clickable" style="text-align: center;width:100%;height:100px;background-color:gray;" ng-click="clickUpload()" >
                        <span style="color:white;vertical-align: middle;line-height: 100px;"><i style="padding-right:5px;" class="fa fa-upload fa-3x" aria-hidden="true"></i> Titelbild hochladen</span>
                    </div>

                    <script>
                        document.getElementById("myupload").onchange = function () {

                            changeBtnText();

                            var reader = new FileReader();

                            reader.onload = function (e) {
                                // get loaded data and render thumbnail.
                                document.getElementById("image").src = e.target.result;
                            };
                            // read the image file as a data URL.
                            reader.readAsDataURL(this.files[0]);
                        };
                    </script>

                </div>
                <div class="col-xs-12 col-sm-6" style="padding:50px;padding-top:0">
                    <input onkeyup="changeBtnText()" id="titelId" value="[[projektInfoBearbeiten[0].title]]" title="Titel muss mindestens 4 Zeichen haben, maximal 50" name="title" style="margin-top:25px;padding:10px;width:100%;border:1px solid black;font-weight: bold;font-size: 20pt;" placeholder="Titel" pattern=".{4,50}" type="text" required>
                    <small style="color:#47A1DE;font-size:18px;">Titel</small>
                    <textarea onkeyup="changeBtnText()" title="Kurzbeschreibung muss mindestens 20 Zeichen haben, maximal 245" name="shortInfo" minlength="20" maxlength="245" style="box-sizing: border-box;margin-top:25px;padding:10px;width:100%;border:1px solid black;font-size: 15pt;height:200px;" placeholder="Kurzbeschreibung" rows="4" cols="50" required>[[projektInfoBearbeiten[0].shortinfo]]</textarea>
                    <small style="color:#47A1DE;font-size:18px;">Kurzbeschreibung</small>
                </div>
            </div>

            <div style="margin-bottom:50px;" class="row">
                <div class="col-xs-12 col-sm-6" style="padding:50px;padding-top: 0">
                    <textarea onkeyup="changeBtnText()" title="Publik Text muss mindestens 20 Zeichen haben, maximal 3000" name="description" minlength="20" maxlength="3000" style="box-sizing: border-box;margin-top:25px;padding:10px;width:100%;border:1px solid black;font-size: 15pt;height:500px;" placeholder="Publik Text" rows="4" cols="50" required>[[projektInfoBearbeiten[0].description]]</textarea>
                    <small style="color:#47A1DE;font-size:18px;">Publik Text</small>
                </div>
                <div class="col-xs-12 col-sm-6" style="padding:50px;padding-top:0">
                    <textarea onkeyup="changeBtnText()" title="Privat Text muss mindestens 20 Zeichen haben, maximal 3000" name="descriptionPrivate" minlength="20" maxlength="3000" style="box-sizing: border-box;margin-top:25px;padding:10px;width:100%;border:1px solid black;font-size: 15pt;height:500px;" placeholder="Privat Text" rows="4" cols="50" required>[[projektInfoBearbeiten[0].descriptionPrivate]]</textarea>
                    <small style="color:#47A1DE;font-size:18px;">Privat Text</small>
                </div>
            </div>

            <div style="margin-bottom:50px;" class="row">
                <div class="col-xs-12 col-sm-6" style="padding:50px;padding-top: 0">
                    <input onchange="changeBtnText()" value="[[projektInfoBearbeiten[0].targetAmount]]" step="0.01" title="Zielbetrag in € muss mindestens 1€ sein" name="targetAmount" min="1" max="9999" style="margin-top:25px;padding:10px;width:100%;border:1px solid black;font-weight: bold;font-size: 20pt;" placeholder="€" type="number" required>
                    <small style="color:#47A1DE;font-size:18px;">Zielbetrag in €</small>
                </div>
                <div class="col-xs-12 col-sm-6" style="padding:50px;padding-top:0">

                    <select onchange="changeBtnText()" id="childs" name="category" style="margin-top:25px;padding:10px;width:100%;border:1px solid black;font-size: 20pt;" name="Kategorie" required>
                        <option value="Bildung">Bildung</option>
                        <option value="Arbeit">Arbeit</option>
                        <option value="Kinder">Kinder</option>
                        <option value="Nahrung">Nahrung</option>
                        <option value="Medizin">Medizin</option>
                        <option value="Technologie">Technologie</option>
                        <option value="Sonstige">Sonstige</option>
                    </select>
                    <small style="color:#47A1DE;font-size:18px;">Projekt-Kategorie</small>

                    <span style="display:none" id="getCategory">[[projektInfoBearbeiten[0].category]]</span>
                    <script>
                        window.onload = function () {
                            var c = document.getElementById("getCategory").innerHTML;
                            var nodes = document.getElementById('childs').childNodes;
                            for(var i=0; i<nodes.length; i++) {
                                if (nodes[i].innerHTML == c) {
                                    nodes[i].setAttribute("selected", "selected");
                                }
                            }
                        }

                        function changeBtnText(){
                            console.log("cahnged");
                            document.getElementById("saveButtonId").setAttribute("class", "uk-button uk-button-danger");
                            document.getElementById("btnTextId").innerHTML = "PROJEKT SPEICHERN";
                        }


                    </script>

                </div>
            </div>

        </form>





            <div style="margin-bottom:50px;" class="row">

                <div class="col-xs-12 col-sm-6" style="padding:50px;padding-top: 0">
                    <input accept="image/*" style="display:none;margin-top:25px;padding:10px;width:100%;border:1px solid black;font-weight: bold;font-size: 20pt;" id="file" type="file" name="file[]" multiple/>

                    <div ng-click="clickUpload2()" class="folgen-detail-btn clickable" style="text-align: center;width:300px;height:50px;"><span style="vertical-align: middle;line-height: 50px;font-size:19px">PROJEKTBILD(ER) HOCHLADEN</span></div>
                </div>

                <div class="col-xs-12 col-sm-6" style="padding:50px;padding-top:0">
                    <div class="uk-slidenav-position" data-uk-slideshow="{animation: 'scroll'}" data-uk-slideshow>
                        <ul id="imagePreview" class="uk-slideshow"></ul>
                        <a href="" class="uk-slidenav uk-slidenav-contrast uk-slidenav-previous" data-uk-slideshow-item="previous"></a>
                        <a href="" class="uk-slidenav uk-slidenav-contrast uk-slidenav-next" data-uk-slideshow-item="next"></a>
                    </div>
                </div>

            </div>

            <script>
                var inputLocalFont = document.getElementById("file");
                inputLocalFont.addEventListener("change",previewImages,false);

                function previewImages(){
                    var fileList = this.files;

                    var anyWindow = window.URL || window.webkitURL;

                    for(var i = 0; i < fileList.length; i++){
                        var objectUrl = anyWindow.createObjectURL(fileList[i]);
                        $('#imagePreview').append('<li><img style="width:100px;" src="' + objectUrl + '" /></li>');
                        window.URL.revokeObjectURL(fileList[i]);
                    }
                }
            </script>


    </div>





    {% include "HtlSpendenportalBundle::footer.html.twig" %}

{% endif %}